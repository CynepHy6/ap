{
    "blocks": [],
    "contracts": [
        {
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract sysparams_AcceptVES{\n    data {\n        KeyId string\n    }\n    conditions {\n        if !($original_contract==\"voting_CheckDecision\" || $original_contract==\"voting_UpdateDataForGraphs\"){\n            warning \"You can't run the contract directly\"\n        }\n        $Id = Int($KeyId)\n\n        if !DBFind(\"ecosystems\").Where(\"id=?\", $Id).Row() {\n            Println(\"Ecosystem not found\")\n            warning \"Ecosystem not found\"\n        }\n    }\n\n    action {\n        DBUpdate(\"ecosystems\", $Id, \"is_valued\", 1)\n    }\n}",
            "Name": "sysparams_AcceptVES"
        },
        {
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract sysparams_AcceptValidator{\n    data{\n        VotingTemplateId string\n        KeyId string\n        VotingId string\n    }\n    func conditions{\n        var app_id int\n        app_id = Int(DBFind(\"applications\").Columns(\"name,id\").Where(\"name='Basic application'\").One(\"id\"))\n        var templateId int\n        templateId = Int(AppParam(app_id,\"voting_validators_template_id\"))\n        \n        var params map\n        params = DBFind(\"voting_templates\").Where(\"id=?\", templateId).Row()\n        if params{\n            warning \"Voting params not found\"\n        }\n\n        $Id = Int($KeyId)\n        var candidateId, oldRoleId, roleId int\n        oldRoleId = 2 // Candidate for validators\n        roleId = 3 // Validator\n        \n        candidateId = DBFind(\"sysparams_candidate\").Where(\"id=?\",$Id).One(\"candidate_key_id\")\n        if !candidateId {\n            warning \"Candidate key id not found\"\n        }\n        $rowId = Int(DBFind(\"roles_participants\").Where(\"deleted=0 and role->id=? and member->member_id=?\", oldRoleId, candidateId).One(\"id\"))\n        \n        $roleId = Int(DBFind(\"roles\").Where(\"role->id=? and deleted=0\", roleId).One(\"id\"))\n        if $roleId == 0 {\n            warning \"Validator role not found\"\n        }\n    }\n    \n    func action{\n        if $rowId > 0 {\n            Roles_Unassign(\"row_id\", $rowId)\n        }\n        Roles_Assign(\"rid,member_id\", $roleId, $Id)\n    }\n}",
            "Name": "sysparams_AcceptValidator"
        },
        {
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract sysparams_CandidateValidatorRequest{\n    data{\n        HostIp string\n        // CommissionPub string\n        CommissionAddress string\n        Description string \"optional\"\n        Comment string \"optional\"\n    }\n    \n    func IsNotValidIp(ip string)bool{\n        var parts array\n        var i, lenParts, part int\n        parts = Split(ip, \".\")\n        \n        lenParts = Len(parts)\n        if lenParts != 4{\n            return true\n        }\n        while i< lenParts {\n            part = Int(parts[i])\n            if part < 0{\n                return true\n            }\n            if part > 255{\n                return true\n            }\n            i = i+1\n        }\n        \n        return false\n    }\n    \n    conditions{\n        // $CommissionPub = Replace($CommissionPub, \" \", \"\")\n        // info Sprintf(\"%v %v\", $CommissionAddress, PubToID($CommissionPub))\n        // if $CommissionAddress != PubToID($CommissionPub) {\n        // info \"Address or Public key are invalid\"\n        // }\n        \n        $CommissionAddress = AddressToId($CommissionAddress)\n        if !DBFind(\"keys\").Where(\"id=?\", $CommissionAddress).Row(){\n            warning \"Address not valid\"\n        }\n        \n        if IsNotValidIp($HostIp){\n            warning \"Please enter a valid ip address\"\n        }\n        var roleName string\n        var roleId int\n        var role map\n        roleName = \"Candidate for validators\"\n        roleId = 2\n        role = DBFind(\"roles\").Where(\"role_name=? and id=? and deleted=0\", roleName, roleId).Row()\n        if !role{\n            warning Sprintf(\"Role %q not found\", roleName)\n        }\n        Roles_Assign(\"rid,member_id\", roleId, $key_id)\n    }\n    \n    action{\n        \n        DBInsert(\"sysparams_candidate\", \"host_ip,commission_pub,commission_address,description,comment,candidate_key_id,timestamp date_created,deleted\", $HostIp, \"\", $CommissionAddress, $Description, $Comment, $key_id, $block_time, 0)\n        \n    }\n    \n}",
            "Name": "sysparams_CandidateValidatorRequest"
        },
        {
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract sysparams_CandidateValidator_Delete{\n    data{\n        Id int\n    }\n    conditions{\n        var candidateId, roleId int\n        roleId = 2 // Candidate for validators\n        candidateId = DBFind(\"sysparams_candidate\").Where(\"id=?\",$Id).One(\"candidate_key_id\")\n        \n        $role = DBFind(\"roles_participants\").Where(\"deleted=0 and role->id=? and member->member_id=?\", roleId, candidateId).Row()\n        if !$role {\n            warning \"Candidate role not found\"\n        }\n    }\n    action{\n        DBUpdate(\"sysparams_candidate\", $Id, \"deleted\", 1)\n        Roles_Unassign(\"row_id\", Int($role[\"id\"]))\n    }\n}",
            "Name": "sysparams_CandidateValidator_Delete"
        },
        {
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract sysparams_DelegateRefresh{\n    func NotInArray(val string, arr array) bool{\n        var i int\n        // info arr\n        while i< Len(arr){\n            if val == arr[i]{\n                return false\n            }\n            i=i+1\n        }\n        return true\n    }\n    \n    conditions{\n        MainCondition()\n        \n        var ROLE_NAME string\n        var ROLE_ID int\n        ROLE_NAME = \"Delegate\"\n        ROLE_ID = 5\n        \n        // get role Id and Type\n        $role = DBFind(\"roles\").Where(\"role_name=? and id=? and delete=0\", ROLE_NAME, ROLE_ID).Row()\n        if !$role{\n            warning Sprintf(\"Role %q not found\", ROLE_NAME)\n        }\n        \n        $app_id = Int(DBFind(\"applications\").Columns(\"name,id\").Where(\"name='Basic application'\").One(\"id\"))\n        if AppParam($app_id, \"last_ecosystem_number\") == 0 {\n            warning \"last ecosystem number unknown\"\n        }\n    }\n    \n    action{\n        var DELEGATE_ACCOUNT string\n        DELEGATE_ACCOUNT = \"delegate_account\"\n        // get delegates ids\n        var delegateIds, currentDelegates array\n        var dIndex, i int\n        \n        var lastEcosystemNumber int\n        lastEcosystemNumber = Int(AppParam($app_id,\"last_ecosystem_number\"))\n        \n        i = 1\n        while i <= lastEcosystemNumber {\n            var delegateParam map\n            delegateParam = DBFind(\"parameters\").Where(\"name=?\", DELEGATE_ACCOUNT).Ecosystem(i).Row()\n            if !delegateParam{\n                delegateParam = DBFind(\"parameters\").Where(\"name='founder_account'\").Ecosystem(i).Row()\n            }\n            var delegateValue string\n            delegateValue = delegateParam[\"value\"]\n            if NotInArray(delegateValue, delegateIds){\n                delegateIds[dIndex] = delegateValue\n                dIndex = dIndex + 1\n            }\n            i = i + 1\n        }\n        \n        // remove old role assigns\n        currentDelegates = DBFind(\"roles_participants\").Where(\"role->id=? and deleted=0\", $role[\"id\"])\n        i = 0\n        while i < Len(currentDelegates){\n            var delegate map\n            delegate = currentDelegates[i]\n            if NotInArray(delegate[\"member_id\"], delegateIds){\n                var id int\n                id = Int(delegate[\"id\"])\n                Roles_Unassign(\"row_id\", id)\n            }\n            i = i + 1\n        }\n        \n        // assign new roles\n        i = 0\n        while i < Len(delegateIds) {\n            var delegateId int\n            delegateId = Int(delegateIds[i])\n            var member map\n            member = DBFind(\"members\").Where(\"id=?\",delegateId).Row()\n            if member{\n                // check role dup\n                var assigned map\n                assigned = DBFind(\"roles_participants\").Where(\"member->member_id=? and role->id=? and deleted=0\", delegateId, $role[\"id\"]).Row()\n                if !assigned{\n                    Roles_Assign(\"rid,member_id\", Int($role[\"id\"]), Int(member[\"id\"]))\n                }\n            }\n            i=i+1\n        }\n    }\n}",
            "Name": "sysparams_DelegateRefresh"
        },
        {
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract sysparams_InvestorRefresh {\n    func NotInArray(val string, arr array) bool{\n        var i int\n        // info arr\n        while i< Len(arr){\n            if val == arr[i]{\n                return false\n            }\n            i=i+1\n        }\n        return true\n    }\n    conditions{\n        MainCondition()\n        \n        // roles:id == 4 Investor with voting rights\n        $roleId = Int(DBFind(\"roles\").Where(\"id=4 and deleted=0\").One(\"id\"))\n        if !$roleId{\n            warning \"Investor role not found\"\n        }\n        var appId int\n        appId = Int(DBFind(\"applications\").Columns(\"name,id\").Where(\"name='Basic application'\").One(\"id\"))\n        $limitInvestors = Int(AppParam(appId,\"investors_number\"))\n        if $limitInvestors == 0 {\n            warning \"Investors number not set\"\n        }\n    }\n    \n    action{\n        // get investors ids\n        var keysInvestors, assignedInvestors, investorsIds, assignedIds array\n        var dIndex, i int\n        keysInvestors = DBFind(\"keys\").Order(\"amount desc, id\").Limit($limitInvestors)\n        assignedInvestors = DBFind(\"roles_participants\").Where(\"role->id=? and deleted=0\", $roleId)\n        \n        // get ids\n        i=0\n        while i < Len(keysInvestors) {\n            var inv map\n            inv = keysInvestors[i]\n            investorsIds[i] = inv[\"id\"]\n            i = i + 1\n        }\n        i=0\n        while i < Len(assignedInvestors) {\n            var inv map\n            inv = assignedInvestors[i]\n            assignedIds[i] = inv[\"member_id\"]\n            i = i + 1\n        }\n        \n        // remove old investors\n        i = 0\n        while i < Len(assignedIds) {\n            if NotInArray(assignedIds[i], investorsIds){\n                var assigned map\n                assigned = DBFind(\"roles_participants\").Where(\"member->member_id=? and role->id=?\", assignedIds[i], $roleId).Row()\n                if assigned {\n                    Roles_Unassign(\"row_id\", Int(assigned[\"id\"]))\n                }\n            }\n            i = i+1\n        }\n        // add new investors\n        i = 0\n        while i < Len(investorsIds) {\n            if NotInArray(investorsIds[i], assignedIds){\n                Roles_Assign(\"rid,member_id\", $roleId, investorsIds[i])\n            }\n            i = i+1\n        }\n    }\n}",
            "Name": "sysparams_InvestorRefresh"
        },
        {
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract sysparams_ValidatorResign{\n    data{}\n    \n    conditions{\n        $assigned = DBFind(\"roles_participants\").Columns(\"id,member->member_id,role->id,role->name,deleted\").Where(\"member->member_id=? and role->id='3' and role->name='Validator' and deleted=0\", $key_id).One(\"id\")\n        if !$assigned {\n            warning \"You are not a validator\"\n        }\n    }\n    \n    action{\n        Roles_Unassign(\"row_id\", Int($assigned))\n        sysparams_RemoveNode()\n}\n    }",
            "Name": "sysparams_ValidatorResign"
        },
        {
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract sysparams_StartNodeAdd{\n    data{\n        TcpAddress string\n        ApiAddress string\n        KeyId int\n        PubKey string\n        TemplateId int\n        Start string \"date\"\n        End string \"date\"\n        EndTime string \"date\"\n        StartTime string \"date\"\n    }\n    func warn(name, detail string){\n        warning Sprintf(\"%v invalid (%v)\", name, detail)\n    }\n    func checkApiAddress(addr string){\n        var name string\n        name = \"API Address\"\n        if Size(addr) == 0 {\n            warn(name, \"size\")\n        }\n        if !(HasPrefix(addr, \"http://\") || HasPrefix(addr, \"https://\")) {\n            warn(name, \"protocol\")\n        }\n        if Contains(addr, \" \") {\n            warn(name, \"space\")\n        }\n        addr = Replace(addr, \"http://\", \"\")\n        addr = Replace(addr, \"https://\", \"\")\n        var parts array\n        if Contains(addr, \":\") {\n            parts = Split(addr, \":\")\n            if Len(parts) > 2 {\n                warn(name, \":\")\n            }\n            var port string\n            port = parts[1]\n            if port <= 0 {\n                warn(name, \"port\")\n            }\n            addr = parts[0]\n        }\n    }\n    func checkTcpAddress(addr string){\n        var name string\n        name = \"TCP Address\"\n        if Size(addr) == 0 {\n            warn(name, \"size\")\n        }\n        if Contains(addr, \" \") {\n            warn(name, \"space\")\n        }\n        var parts array\n        if Contains(addr, \":\") {\n            parts = Split(addr, \":\")\n            if Len(parts) > 2 {\n                warn(name, \":\")\n            }\n            var port string\n            port = parts[1]\n            if port <= 0 {\n                warn(name, \"port\")\n            }\n            addr = parts[0]\n        }\n        parts = Split(addr, \".\")\n        if Len(parts) != 4 {\n            warn(name, \"too many parts\")\n        }\n        var i int\n        while i < 4 {\n            var n int\n            n = Int(parts[i])\n            if n < 0 || n > 255 {\n                warn(name, \"part\")\n            }\n            i=i+1\n        }\n    }\n    func checkPub(pub string){\n        if PubToID(pub) == 0 {\n            warning \"Public key invalid\"\n        }\n    }\n    func checkKeyId(keyid int){\n        var existed map\n        existed = DBFind(\"keys\").Where(\"id=?\", keyid).Row()\n        if !existed {\n            warning \"Key id not found\"\n        }\n    }\n    func getNodesString() string{\n        // kostyl\n        // return json-like string from full_nodes trimmed \"[\" and \"]\"\n        var nodes string\n        nodes = SysParamString(\"full_nodes\")\n        if HasPrefix(nodes, \"[\") {\n            nodes = Substr(nodes, 1, Size(nodes)-2)\n        }\n        return nodes\n    }\n    conditions{\n        var app_id int\n        app_id = Int(DBFind(\"applications\").Columns(\"name,id\").Where(\"name='Basic application'\").One(\"id\"))\n        var id int\n        id = Int(AppParam(app_id,\"voting_sysparams_template_id\"))\n        if $TemplateId != id || $TemplateId <= 0 {\n            warning \"Template id not found\"\n        }\n        checkKeyId($KeyId)\n        checkPub($PubKey)\n        checkApiAddress($ApiAddress)\n        checkTcpAddress($TcpAddress)\n    }\n    \n    action{\n        var sep, nodes, value int\n        sep = \",\"\n        nodes = getNodesString()\n        if Size(nodes) == 0{\n            sep = \"\"\n        }\n        value = Sprintf(`{\"tcp_address\":\"%v\", \"api_address\":\"%v\", \"key_id\":\"%v\", \"public_key\":\"%v\"}`, $TcpAddress, $ApiAddress, $KeyId, $PubKey)\n        nodes = Sprintf(\"[%v%v%v]\", nodes, sep, value)\n        voting_TemplateRun(\"TemplateId,Start,End,EndTime,StartTime,KeyId,TableWritten,RowId,ColumnName,NewValue,TextDocument\", $TemplateId, $Start, $End, $EndTime, $StartTime, 0, \"\", \"\", \"full_nodes\", nodes, \"\")\n    }\n}",
            "Name": "sysparams_StartNodeAdd"
        },
        {
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract sysparams_StartVotingValidator{\n    data{\n        KeyId int\n    }\n    \n    conditions{\n        ContractConditions(\"MainCondition\")\n        $candidate = DBFind(\"sysparams_candidate\").Where(\"candidate_key_id=? and deleted=0\", $KeyId).Row()\n        if !$candidate{\n            warning \"Candidate not found\"\n        }\n    }\n    action{\n        sysparams_DelegateRefresh()\n    }\n}",
            "Name": "sysparams_StartVotingValidator"
        },
        {
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract sysparams_UpdateFullNodesKeysList{\n    data{\n        Param string\n    }\n    func jsonToArray(json string) array {\n        // kostyl\n        var res, parts array\n        if HasPrefix(json, \"[\") {\n            json = Substr(json, 1, Size(json)-2)\n            if Contains(json, \"},\"){\n                // json have many objects\n                parts = Split(json, \"},\")\n                var i int\n                while i < Len(parts){\n                    var p, lastSym string\n                    p = parts[i]\n                    lastSym = Substr(p, Size(p)-1, 1)\n                    if lastSym != \"}\"{\n                        p = Sprintf(\"%v}\", p)\n                    }\n                    res[i] = JSONToMap(p)\n                    i=i+1\n                }\n            }else{\n                res[0] = JSONToMap(json)\n            }\n        }\n        return res\n    }\n    conditions{\n        $FULL_NODES_KEYS = \"full_nodes_keys\"\n        $FULL_NODES = \"full_nodes\"\n        $paramId = DBFind(\"parameters\").Where(\"name=?\", $FULL_NODES_KEYS).One(\"id\")\n    }\n    \n    action{\n        if $Param != $FULL_NODES {\n            return\n        }\n        var nodesJson string\n        nodesJson = SysParamString($FULL_NODES)\n        var nodes, keys array\n        nodes = jsonToArray(nodesJson)\n        \n        var i int\n        while i<Len(nodes){\n            var node map\n            node = nodes[i]\n            keys[i] = node[\"key_id\"]\n            i=i+1\n        }\n        var keysList, cond string\n        keysList = Join(keys, \",\")\n        cond = `ContractConditions(\"MainCondition\")`\n        if $paramId {\n            DBUpdate(\"parameters\", Int($paramId), \"value,conditions\", keysList, cond)\n        }else{\n            DBInsert(\"parameters\", \"name,value,conditions\", $FULL_NODES_KEYS, keysList, cond)\n        }\n    }\n}",
            "Name": "sysparams_UpdateFullNodesKeysList"
        },
        {
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract sysparams_RemoveNode{\n    data{}\n    func jsonToArray(json string) array {\n        // KOSTYL\n        var res, parts array\n        if Size(json) < 60 {\n            // fastway empty|incorrect detect\n            return res\n        }\n        if HasPrefix(json, \"[\") {\n            json = Substr(json, 1, Size(json)-2)\n            if Contains(json, \"},\"){\n                // json have many objects\n                parts = Split(json, \"},\")\n                var i int\n                while i < Len(parts){\n                    var p, lastSym string\n                    p = parts[i]\n                    lastSym = Substr(p, Size(p)-1, 1)\n                    if lastSym != \"}\"{\n                        p = Sprintf(\"%v}\", p)\n                    }\n                    res[i] = JSONToMap(p)\n                    i=i+1\n                }\n            }else{\n                if HasPrefix(json, \"{\"){\n                    res[0] = JSONToMap(json)\n                }\n            }\n        }\n        return res\n    }\n    func nodesRemove(keyId int) array{\n        var json string\n        var nodes, res array\n        json = SysParamString(\"full_nodes\")\n        if !HasPrefix(json, \"[\") {\n            // empty string nodes\n            return res\n        }\n        nodes = jsonToArray(json)\n        var i, i_res int\n        while i < Len(nodes){\n            var node map\n            node = nodes[i]\n            if node[\"key_id\"] != keyId {\n                res[i_res] = node\n                i_res = i_res+1\n            }\n            i=i+1\n        }\n        return res\n    }\n    func nodesArrayToJson(nodes array) string{\n        var res string\n        var json array\n        if Len(nodes) == 0 {\n            res = \"[]\"\n            return res\n        }\n        var i int\n        while i < Len(nodes){\n            var node map\n            node = nodes[i]\n            json[i] = Sprintf(`{\"tcp_address\":\"%v\", \"api_address\":\"%v\", \"key_id\":\"%v\", \"public_key\":\"%v\"}`, node[\"tcp_address\"], node[\"api_address\"], node[\"key_id\"], node[\"public_key\"])\n            i=i+1\n        }\n        res = Join(json, \",\")\n        res = Sprintf(\"[%v]\", res)\n        return res\n    }\n    conditions{\n        if $original_contract != \"sysparams_ValidatorResign\"{\n            warning \"Unknown contract\"\n        }\n    }\n    \n    action{\n        var nodes array\n        nodes = nodesRemove($key_id)\n        var fullNodes string\n        fullNodes = nodesArrayToJson(nodes)\n        DBUpdateSysParam(\"full_nodes\", fullNodes, \"\")\n    }\n}",
            "Name": "sysparams_RemoveNode"
        }
    ],
    "data": [
        {
            "Table": "voting_templates",
            "Columns": [
                "volume",
                "init_contract",
                "contract_reject",
                "contract_accept",
                "title",
                "vacancies",
                "candidates",
                "reject_params",
                "type_decision",
                "type_voting",
                "type_participants",
                "quorum",
                "voters",
                "subject",
                "accept_params"
            ],
            "Data": [
                [
                    "50",
                    "sysparams_StartVotingValidator",
                    "",
                    "sysparams_AcceptValidator",
                    "Voting for Validator",
                    "1",
                    "2",
                    "",
                    "2",
                    "2",
                    "3",
                    "50",
                    "5",
                    "Validator",
                    ""
                ],
                [
                    "75",
                    "sysparams_InvestorRefresh",
                    "",
                    "",
                    "Voting for System param",
                    "0",
                    "4",
                    "",
                    "4",
                    "2",
                    "3",
                    "50",
                    "4",
                    "System param",
                    ""
                ],
                [
                    "75",
                    "sysparams_InvestorRefresh",
                    "sysparams_AcceptVES",
                    "",
                    "Voting for Valued Ecosystem",
                    "0",
                    "4",
                    "",
                    "5",
                    "2",
                    "3",
                    "50",
                    "4",
                    "System param",
                    ""
                ]
            ]
        }
    ],
    "languages": [
        {
            "Name": "delete_node",
            "Trans": "{\"en\": \"Delete node\", \"ru\": \"Удалить узел\"}"
        },
        {
            "Name": "delete_node_desc",
            "Trans": "{\"en\": \"The owner of the validating node can remove it from the list without a vote. Your key_id were found in the list of node owners and you can delete your entry at any time\", \"ru\": \"Владелец валидирующего узла может удалить его из списка без голосования. Ваш key_id был найден в списке владельцев узлов и вы можете удалить свою запись в любое время\"}"
        },
        {
            "Name": "new_value",
            "Trans": "{\"en\": \"New value\", \"ru\": \"Новое значение\"}"
        },
        {
            "Name": "resign",
            "Trans": "{\"en\": \"Resign\", \"ru\": \"В отставку\"}"
        },
        {
            "Name": "sysparams_candidate_validators_form",
            "Trans": "{\"en\":\"Request form of candidate for validators\",\"ru\":\"Форма запроса кандидата в валидаторы\"}"
        },
        {
            "Name": "sysparams_candidates",
            "Trans": "{\"en\":\"Candidate for validators\",\"ru\":\"Кандидаты в валидаторы\"}"
        },
        {
            "Name": "sysparams_list",
            "Trans": "{\"en\":\"System parameters list\",\"ru\":\"Список системных параметров\"}"
        },
        {
            "Name": "validator_removing",
            "Trans": "{\"en\": \"Validator's removing\", \"ru\": \"Удаление валидатора\"}"
        },
        {
            "Name": "validator_removing_desc",
            "Trans": "{\"en\": \"You are a Validator. At any time you can remove the entry about your node and leave with a role of Validator\", \"ru\": \"Вы являетесь Валидатором. В любой момент вы можете удалить запись о своем узле и уйти с роли Валидатор\"}"
        },
        {
            "Name": "voting_template_not_found",
            "Trans": "{\"en\": \"The template ID to vote is not found in the parameters of the ecosystem\", \"ru\": \"Идентификатор шаблона голосования не найден в параметрах экосистемы\"}"
        },
        {
            "Name": "want_resign",
            "Trans": "{\"en\": \"Are you sure you want to resign the role of the Validator?\", \"ru\": \"Вы действительно хотите уйти с роли Валидатор?\"}"
        }
    ],
    "menus": [
        {
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "MenuGroup(Title:$admin$, Icon:\"fa icon-settings\"){\n    MenuItem(Title: $sysparams_list$,Page:sysparams_list, Icon:\"fa icon-settings\")\n    MenuItem(Title:$sysparams_candidates$, Page:sysparams_candidates, Icon:\"icon-list\")\n}",
            "Name": "default_menu"
        }
    ],
    "pages": [
        {
            "Conditions": "ContractAccess(\"@1EditPage\")",
            "Value": "Div(content-wrapper){\n    \n    SetTitle($sysparams_candidate_validators_form$)\n    Div(Class: breadcrumb){\n        LinkPage($sysparams_candidates$, sysparams_candidates)\n        Span(/).Style(margin-right: 10px; margin-left: 10px;)\n        Span(Class: text-muted, Body: $sysparams_candidate_validators_form$)\n    }\n    \n    Div(row){\n        Div(col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2){\n            Form(panel panel-primary){\n                Div(panel-body){\n                    Div(form-group) {\n                        Label(LangRes(host_ip)*)\n                        Input(Name: HostIp, Type: text, Placeholder: xxx.xxx.xxx.xxx).Validate(minLength:7, maxLength:15)\n                        InputErr(Name: HostIp, minLength: Value is too short, maxLength: Value is too long)\n                    }\n                    If(){\n                        Div(form-group) {\n                            Label(LangRes(commission_pub)*)\n                            Input(Name: CommissionPub, Type: text).Validate(minLength:128)\n                            InputErr(Name: CommissionPub, minLength: Invalid pub-key)\n                        }\n                    }\n                    Div(form-group) {\n                        Label(LangRes(commission_address)*)\n                        Input(Name: CommissionAddress, Type: text,Placeholder:xxxx-xxxx-xxxx-xxxx-xxxx).Validate(minLength:24, maxLength:24)\n                        InputErr(Name: CommissionAddress, minLength: Invalid address, maxLength: Invalid address)\n                    }\n                    Div(form-group) {\n                        Label(LangRes(description_equipment))\n                        Input(Name: Description, Type: textarea)\n                    }\n                    Div(form-group) {\n                        Label(LangRes(comment))\n                        Input(Name: Comment, Type: textarea)\n                    }\n                }\n\t\t\t\tDiv(panel-footer clearfix){\n\t\t\t\t\tDiv(pull-right){\n                        Button(Body: LangRes(back), Class: btn btn-default, Page: sysparams_candidates)\n                    \tButton(Contract: sysparams_CandidateValidatorRequest, Class: btn btn-primary, Page: sysparams_candidates, Body: $send$)\n\t\t\t\t\t}\n\t\t\t\t}\n            }\n        }\n    }\n}",
            "Name": "sysparams_candidate_validators_form",
            "Menu": "default_menu"
        },
        {
            "Conditions": "ContractAccess(\"@1EditPage\")",
            "Value": "DBFind(Name:applications, Source:src_app).Columns(\"name,id\").Where(\"name='Basic application'\").Vars(app)\nSetVar(template_id, AppParam(App:#app_id#, Name: voting_validators_template_id))\nSetTitle($sysparams_candidates$)\n\nDBFind(Name:sysparams_candidate, Source: src_candidates).Where(\"deleted=0\").Custom(_actions){\n    If(#template_id#>0){\n        Div(btn-group){\n            Input(Name:KeyId, Type: hidden, Value: #candidate_key_id#)\n            Input(Name:TemplateId, Type: hidden, Value: #template_id#)\n            Button(Body: $voting_start$, Contract: voting_TemplateRun, Page: voting_list, Class: btn btn-success)\n        }\n    }.Else{\n        Button(Class: btn btn-warning icon-question, Page: sysparams_candidates).Alert(Text: $voting_template_not_found$, ConfirmButton: $yes$, CancelButton: $no$, Icon: info)\n    }\n    \n}.Custom(_date){\n    DateTime(DateTime: #date_created#, Format: YYYY-MM-DD HH:MI)\n}\n\nDiv(content-wrapper){\n    Div(breadcrumb){\n        Span(Class: text-muted, Body: $sysparams_candidates$)\n    }\n    \n    Div(row){\n        Div(col-md-12){\n            Div(panel panel-primary){\n                Form(table-responsive){\n                    Input(Name:Start, Type: hidden, Value: Now(\"YYYY-MM-DD\", +1 days))\n                    Input(Name:StartTime, Type: hidden, Value: Now(\"HH:MI\"))\n                    Input(Name:End, Type: hidden, Value: Now(\"YYYY-MM-DD\", +14 days))\n                    Input(Name:EndTime, Type: hidden, Value: Now(\"HH:MI\"))\n                    Table(Source: src_candidates, Columns: \"$id$=id,$host_ip$=host_ip,$commission_address$=commission_address,$description_equipment$=description,$comment$=comment,$date_created$=_date,=_actions\")\n                }\n                Div(panel-footer text-right){\n                    Button(Body: $add$, Class: btn btn-primary, Page: sysparams_candidate_validators_form)\n                }\n            }\n        }\n    }\n}",
            "Name": "sysparams_candidates",
            "Menu": "default_menu"
        },
        {
            "Conditions": "ContractAccess(\"@1EditPage\")",
            "Value": "SetTitle($system_params$)\nJsonToSource(nodes){SysParam(full_nodes)}\nForList(nodes){\n    Div(#key_id#)\n}\nDiv(content-wrapper){\n    Div(breadcrumb){\n        Span(Class: text-muted, Body: $system_params$)\n    }\n    Div(row){\n        Div(col-sm-12 col-lg-10 col-lg-offset-1){\n            Form(panel panel-primary){\n                Div(panel-body){\n                    Div(form-group){\n                        Div(row){\n                            Div(col-sm-4 text-center){Strong($name$)}\n                            Div(col-sm-6 text-center){Strong($value$)}\n                        }\n                    }\n                    Data(Source: src_parameters, Columns: name){\n                        gap_between_blocks\n                        default_ecosystem_page\n                        full_nodes\n                        ecosystem_price\n                        blockchain_url\n                        max_block_size\n                    }\n                    ForList(Source: src_parameters, Index: index){\n                        Div(form-group){\n                            Div(row){\n                                Div(col-sm-4){\n                                    #name#\n                                }\n                                Div(col-sm-6){\n                                    SysParam(#name#)\n                                }.Style(overflow:hidden;)\n                                Div(col-sm-2){\n                                    Button(Body: $edit$, Class: btn btn-block btn-primary, Page: sysparams_voting, PageParams: \"param_index=#index#,param_name=#name#\", Contract: sysparams_UpdateFullNodesKeysList, Params: \"Param=#name#\")\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n    DBFind(Name: roles_participants, Source: roles).Columns(\"id,member->member_id,role->id,role->name,deleted\").Where(\"member->member_id='#key_id#' and role->id='3' and role->name='Validator' and deleted=0\").Vars(validator)\n    If(#validator_id#>0){\n        Div(row){\n            Div(col-md-6 col-md-offset-3){\n                Div(panel panel-primary text-center){\n                    Div(panel-heading){$validator_removing$}\n                    Div(panel-body text-center){$validator_removing_desc$}\n                    Div(panel-footer text-right){\n                        Button(Body: $resign$, Class: btn btn-danger, Page: sysparams_list, Contract: sysparams_ValidatorResign).Alert(Text: $want_resign$, ConfirmButton: $yes$, CancelButton: $no$, Icon: question)\n                    }\n                }\n            }\n        }\n    }\n}\nIf(){\n    default_ecosystem_menu\n    default_ecosystem_contract\n    rb_blocks_1\n    new_version_url\n    number_of_nodes\n    contract_price\n    column_price\n    table_price\n    menu_price\n    page_price\n    max_tx_size\n    max_tx_count\n    max_columns\n    max_indexes\n    max_block_user_tx\n    max_fuel_tx\n    max_fuel_block\n    commission_size\n    commission_wallet\n    fuel_rate\n    extend_cost_address_to_id\n    extend_cost_id_to_address\n    extend_cost_new_state\n    extend_cost_sha256\n    extend_cost_pub_to_id\n    extend_cost_ecosys_param\n    extend_cost_sys_param_string\n    extend_cost_sys_param_int\n    extend_cost_sys_fuel\n    extend_cost_validate_condition\n    extend_cost_eval_condition\n    extend_cost_has_prefix\n    extend_cost_contains\n    extend_cost_replace\n    extend_cost_join\n    extend_cost_update_lang\n    extend_cost_size\n    extend_cost_substr\n    extend_cost_contracts_list\n    extend_cost_is_object\n    extend_cost_compile_contract\n    extend_cost_flush_contract\n    extend_cost_eval\n    extend_cost_len\n    extend_cost_activate\n    extend_cost_deactivate\n    extend_cost_create_ecosystem\n    extend_cost_table_conditions\n    extend_cost_create_table\n    extend_cost_perm_table\n    extend_cost_column_condition\n    extend_cost_create_column\n    extend_cost_perm_column\n    extend_cost_json_to_map\n    max_block_generation_time\n    block_reward\n}",
            "Name": "sysparams_list",
            "Menu": "default_menu"
        },
        {
            "Conditions": "ContractAccess(\"@1EditPage\")",
            "Value": "DBFind(Name:applications, Source:src_app).Columns(\"name,id\").Where(\"name='Basic application'\").Vars(app)\nSetVar(template_id, AppParam(App:#app_id#, Name:  voting_sysparams_template_id))\nSetTitle($voting$)\n\nDiv(content-wrapper){\n    Div(breadcrumb){\n        LinkPage($system_params$, sysparams_list)\n        Span(/).Style(margin-right: 10px; margin-left: 10px;)\n        Span(Class: text-muted, Body: $voting$)\n    }\n    \n    If(And(#template_id#>0,#param_index#>0,#param_name#!=\"\")){\n        Div(row){\n            Div(col-sm-8 col-sm-offset-2 col-lg-6 col-lg-offset-3){\n                If(#param_name#==\"full_nodes\"){\n                    Form(panel panel-primary){\n                        Input(Name: Start, Type: hidden, Value: Now(\"YYYY-MM-DD\"))\n                        Input(Name: End, Type: hidden, Value: Now(\"YYYY-MM-DD\", 21 days))\n                        Input(Name: StartTime, Type: hidden, Value: Now(\"HH:MI\", +5 minute))\n                        Input(Name: EndTime, Type: hidden, Value: Now(\"HH:MI\", +5 minute))\n                        Input(Name: TemplateId, Type: hidden, Value: #template_id#)\n                        Div(panel-heading text-center h3){\n                            Span(#param_name#).Style(text-transform:uppercase;): Span($add$ $new_value$).Style(text-transform:lowercase;)\n                        }\n                        Data(new_node_form, \"name,type,placeholder,value\"){\n                            TcpAddress,text,tcp_address,\"\"\n                            ApiAddress,text,api_address,\"\"\n                            KeyId,number,key_id,#key_id#\n                            PubKey,text,public_key,\"\"\n                        }\n                        Div(panel-body){\n                            ForList(new_node_form){\n                                Div(row form-group){\n                                    Div(col-md-3 text-right){\n                                        Label(For: #name#){LangRes(#name#)}\n                                    }\n                                    Div(col-md-9 text-left){\n                                        Input(Name: #name#, Placeholder: #placeholder#, Type: #type#, Value: #value#)\n                                    }\n                                }\n                            }\n                        }\n                        Div(panel-footer text-right){\n                            Button(Body: LangRes(back), Class: btn btn-default, Page: sysparams_list)\n                            Button(Body: LangRes(voting), Class: btn btn-primary, Contract: sysparams_StartNodeAdd, Page: voting_list)\n                        }\n                    }\n                    AppParam(App:#app_id#, Name:full_nodes_keys, Source:src_keys)\n                    ForList(Source:src_catalog){\n                        If(#name#==\"key_id\"){\n                            SetVar(node_owner, 1)\n                        }\n                    }\n                    \n                    If(#node_owner#==1){\n                        Form(panel panel-primary){\n                            Div(panel-heading text-center h3){$delete_node$}\n                            Div(panel-body text-center){$delete_node_desc$}\n                            Div(panel-footer text-right){\n                                Button(Body: LangRes(delete), Class: btn btn-danger, Page: sysparams_list, Contract: sysparams_RemoveNode)\n                            }\n                        }\n                    }\n                    If(\"\" != SysParam(full_nodes)){\n                        Div(panel panel-primary){\n                            Div(panel-heading text-center h3){full_nodes}\n                            Div(panel-body text-center){\n                                Div(col-sm-12 text-center){\n                                    SysParam(full_nodes)\n                                }.Style(overflow-x:hidden)\n                            }\n                        }\n                    }\n                }.Else{\n                    Form(panel panel-primary){\n                        Input(Name: Start, Type: hidden, Value: Now(\"YYYY-MM-DD\"))\n                        Input(Name: End, Type: hidden, Value: Now(\"YYYY-MM-DD\", 21 days))\n                        Input(Name: StartTime, Type: hidden, Value: Now(\"HH:MI\", +2 minute))\n                        Input(Name: EndTime, Type: hidden, Value: Now(\"HH:MI\", +2 minute))\n                        Input(Name: TemplateId, Type: hidden, Value: #template_id#)\n                        Div(panel-heading text-center h3){#param_name#}\n                        Div(panel-body){\n                            Div(form-group){\n                                Div(row){\n                                    Div(col-md-3 mt-sm text-right){\n                                        Label(For: NewValue){LangRes(new_value)}\n                                    }\n                                    Div(col-md-9 mc-sm text-left){\n                                        Input(Name: NewValue, Value: \"SysParam(#param_name#)\", Type: textarea)\n                                    }\n                                }\n                            }\n                        }\n                        Div(panel-footer text-right){\n                            Button(Body: LangRes(back), Class: btn btn-default, Page: sysparams_list)\n                            Button(Body: LangRes(voting), Class: btn btn-primary, Contract: voting_TemplateRun, Params: \"ColumnName=#param_name#\", Page: voting_list)\n                        }\n                    }\n                }\n            }\n        }\n    }.Else{\n        If(#param_index#>0){}.Else{\n            Div(col-md-12 alert alert-danger text-center){\n                Div(){LangRes(attention)}\n            }\n        }\n        If(#template_id#>0){}.Else{\n            Div(col-md-12 alert alert-danger text-center){\n                Div(){LangRes(voting_template_not_found)}\n            }\n        }\n    }\n}",
            "Name": "sysparams_voting",
            "Menu": "default_menu"
        }
    ],
    "parameters": [
        {
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "0",
            "Name": "investors_number"
        },
        {
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "0",
            "Name": "last_ecosystem_number"
        },
        {
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "0",
            "Name": "voting_sysparams_template_id"
        },
        {
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "0",
            "Name": "voting_validators_template_id"
        }
    ],
    "tables": [
        {
            "Name": "sysparams_candidate",
            "Columns": "[\n    {\n        \"name\": \"commission_address\",\n        \"type\": \"number\",\n        \"conditions\": \"true\"\n    },\n    {\n        \"name\": \"comment\",\n        \"type\": \"text\",\n        \"conditions\": \"true\"\n    },\n    {\n        \"name\": \"deleted\",\n        \"type\": \"number\",\n        \"conditions\": \"true\"\n    },\n    {\n        \"name\": \"host_ip\",\n        \"type\": \"varchar\",\n        \"conditions\": \"true\"\n    },\n    {\n        \"name\": \"description\",\n        \"type\": \"text\",\n        \"conditions\": \"true\"\n    },\n    {\n        \"name\": \"date_created\",\n        \"type\": \"datetime\",\n        \"conditions\": \"true\"\n    },\n    {\n        \"name\": \"commission_pub\",\n        \"type\": \"varchar\",\n        \"conditions\": \"true\"\n    },\n    {\n        \"name\": \"candidate_key_id\",\n        \"type\": \"number\",\n        \"conditions\": \"true\"\n    }\n]",
            "Permissions": "{\"insert\":\"true\",\"update\":\"true\",\"new_column\":\"true\"}"
        }
    ]
}